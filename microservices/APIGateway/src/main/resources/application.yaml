spring:
  application:
    name: APIGateway

server:
  port: 8090

cloud:
  gateway:
    # This enables the gateway to use Eureka to find services
    discovery:
      locator:
        enabled: true
    routes:
      # 1. Route to IAM Service
      - id: iam-service
        # MODERN CHANGE: Use lb:// instead of http://localhost:7000
        uri: lb://iam-service
        predicates:
          - Path=/api/v1/auth/**, /auth/organizations/**

      # 2. Route to Employee Service
      - id: employee-service
        # MODERN CHANGE: Use lb:// instead of http://localhost:8085
        uri: lb://employee-service
        predicates:
          - Path=/api/v1/employees/**, /api/v1/departments/**
        filters:
          - name: AuthFilter

# --- CONNECT TO DISCOVERY SERVER ---
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/

# --- JWT SETTINGS (Same as before) ---
jwt:
  public-key: |
    -----BEGIN PUBLIC KEY-----
    MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxBWod69E2LZroW+5v6m0
    8X6+Gu9wvLlRxTTdLbtY79jjUpduRjA+7IgRb8IeUFtXxZbtIBEecWgkFy3LTQ03
    i4O3jKhJUbR2sat5swx+NV72ZVWZBkPIdfya6KcjMK1iLA6HnXXgDW1Qseh709+w
    XqNy4TPl1rpjdo1ZSBthk84dM0IcJ3wg6/9HFVZ6X9KFw8J+21xF75PCnJfj4Wm8
    8RqhhE49W4WqYCpDWnVKJvLtW45aG2zB+h2EHN/ijanuVLNWBfYtVJH3ROv/stVh
    qXNwdGubwu2IFHNg0JAEK708uchnG7Wcz8c3Vu0GF8HiaWZwqMg3FYhLS4zI73rS
    3wIDAQAB
    -----END PUBLIC KEY-----
  issuer: iam-service

logging:
  level:
    org.springframework.cloud.gateway: DEBUG
    io.jsonwebtoken: DEBUG